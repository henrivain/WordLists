<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="WordListsUI.WordTrainingPage.WordTrainingPage"
             xmlns:flipper="clr-namespace:WordListsUI.WordTrainingPage.FlipCardControl"
             xmlns:viewModel="clr-namespace:WordListsViewModels;assembly=WordListsViewModels"
             xmlns:windows="clr-namespace:Microsoft.Maui.Controls.PlatformConfiguration.WindowsSpecific;assembly=Microsoft.Maui.Controls"
             x:DataType="{x:Type viewModel:IWordTrainingViewModel}"
             Title="Train words" 
             BackgroundColor="{StaticResource PageBackground}"
             x:Name="WordTrainer"
             >
    <ContentPage.Resources>
        <Style TargetType="{x:Type Label}">
            <Setter Property="TextColor" Value="White"></Setter>
        </Style>
    </ContentPage.Resources>
    <ContentPage.Content>
        <ScrollView >
            <VerticalStackLayout >
                <VerticalStackLayout Margin="40,20">
                    <Label Text="{Binding Title}"
                        FontSize="Title"
                        FontAttributes="Bold"
                        LineBreakMode="TailTruncation"
                        />

                    <Label Text="{Binding LanguageHeaders}"
                        Grid.Row="1"
                        FontSize="Subtitle"    
                        />
                </VerticalStackLayout>

                <Grid HeightRequest="{OnIdiom Desktop='300', Default='200'}"
                      Grid.Row="3"
                      ColumnDefinitions="{OnIdiom Phone='0.1*, *, 0.1*', Default='*, *, *'}"
                      SizeChanged="FlipperGrid_SizeChanged"
                      >
                    <flipper:WordPairFlipCard Grid.Column="1"
                                              x:Name="flipper"
                                              VerticalOptions="FillAndExpand"
                                              Margin="0,0"
                                              WordPair="{Binding VisibleWordPair}"
                                              />
                </Grid>
                
                <Grid ColumnDefinitions="*, 0.2*, *" Margin="0,25,0,50" >
                    <Grid.Resources>
                        <Style TargetType="{x:Type ImageButton}">
                            <Setter Property="HeightRequest" Value="40"/>
                            <Setter Property="WidthRequest" Value="40"/>
                            <Setter Property="CornerRadius" Value="20"/>
                            <Setter Property="Padding" Value="2"/>
                            <Setter Property="Margin" Value="20,0"/>
                        </Style>
                    </Grid.Resources>
                    <ImageButton Source="arrow.png" 
                                 IsEnabled="{Binding CanFlipPrevious}"
                                 BackgroundColor="Transparent"
                                 Rotation="180"
                                 HorizontalOptions="End"
                                 Clicked="Button_LastCard"
                                 >
                    </ImageButton>
                    <Label Grid.Column="1"
                           HorizontalOptions="Center"
                           VerticalOptions="Center"
                           >
                        <Label.Text>
                            <MultiBinding StringFormat="{}{0}/{1}">
                                <Binding Path="UIVisibleIndex"/>
                                <Binding Path="MaxWordIndex"/>
                            </MultiBinding>
                        </Label.Text>
                    </Label>
                    <ImageButton Source="arrow.png" 
                                 IsEnabled="{Binding CanFlipNext}"
                                 BackgroundColor="Transparent"
                                 HorizontalOptions="Start"
                                 Grid.Column="2"
                                 Clicked="Button_NextCard"
                                 >
                    </ImageButton>
                </Grid>
            </VerticalStackLayout>
        </ScrollView>
    </ContentPage.Content>
</ContentPage>